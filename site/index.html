<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>pi-rewind â€” The best checkpoint/rewind for Pi</title>
<meta name="description" content="Per-tool checkpoints, /rewind command, Esc+Esc shortcut, safe restore, redo stack â€” the rewind experience Pi deserves.">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
<style>
  :root {
    --font-body: 'Space Grotesk', system-ui, sans-serif;
    --font-mono: 'JetBrains Mono', 'SF Mono', Consolas, monospace;
    --bg: #0c0d14;
    --surface: #14151f;
    --surface2: #1c1d2e;
    --surface-elevated: #1e1f32;
    --border: rgba(255, 255, 255, 0.06);
    --border-bright: rgba(255, 255, 255, 0.12);
    --text: #e5e7eb;
    --text-dim: #9ca3af;
    --accent: #818cf8;
    --accent-dim: rgba(129, 140, 248, 0.12);
    --green: #34d399;
    --green-dim: rgba(52, 211, 153, 0.1);
    --red: #f87171;
    --red-dim: rgba(248, 113, 113, 0.1);
    --orange: #fbbf24;
    --orange-dim: rgba(251, 191, 36, 0.1);
    --blue: #60a5fa;
    --blue-dim: rgba(96, 165, 250, 0.1);
    --purple: #a78bfa;
    --purple-dim: rgba(167, 139, 250, 0.1);
    --cyan: #22d3ee;
    --cyan-dim: rgba(34, 211, 238, 0.1);
  }
  @media (prefers-color-scheme: light) {
    :root {
      --bg: #f7f8fc;
      --surface: #ffffff;
      --surface2: #f0f1f8;
      --surface-elevated: #ffffff;
      --border: rgba(0, 0, 0, 0.07);
      --border-bright: rgba(0, 0, 0, 0.14);
      --text: #111827;
      --text-dim: #6b7280;
      --accent: #6366f1;
      --accent-dim: rgba(99, 102, 241, 0.07);
      --green: #059669;
      --green-dim: rgba(5, 150, 105, 0.08);
      --red: #dc2626;
      --red-dim: rgba(220, 38, 38, 0.08);
      --orange: #d97706;
      --orange-dim: rgba(217, 119, 6, 0.08);
      --blue: #2563eb;
      --blue-dim: rgba(37, 99, 235, 0.08);
      --purple: #7c3aed;
      --purple-dim: rgba(124, 58, 237, 0.08);
      --cyan: #0891b2;
      --cyan-dim: rgba(8, 145, 178, 0.08);
    }
  }
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body {
    background: var(--bg);
    background-image:
      radial-gradient(ellipse at 25% 0%, var(--accent-dim) 0%, transparent 50%),
      radial-gradient(ellipse at 75% 100%, var(--purple-dim) 0%, transparent 40%);
    color: var(--text);
    font-family: var(--font-body);
    padding: 40px;
    min-height: 100vh;
  }
  @keyframes fadeUp { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
  @keyframes fadeScale { from { opacity: 0; transform: scale(0.92); } to { opacity: 1; transform: scale(1); } }
  .a { animation: fadeUp 0.35s ease-out both; animation-delay: calc(var(--i, 0) * 0.04s); }
  .as { animation: fadeScale 0.35s ease-out both; animation-delay: calc(var(--i, 0) * 0.06s); }
  @media (prefers-reduced-motion: reduce) { *, *::before, *::after { animation-duration: 0.01ms !important; transition-duration: 0.01ms !important; } }

  .wrap { max-width: 1400px; margin: 0 auto; display: grid; grid-template-columns: 170px 1fr; gap: 0 40px; }
  .main { min-width: 0; }

  /* TOC */
  .toc { position: sticky; top: 24px; align-self: start; padding: 14px 0; grid-row: 1 / -1; max-height: calc(100dvh - 48px); overflow-y: auto; }
  .toc::-webkit-scrollbar { width: 3px; }
  .toc::-webkit-scrollbar-thumb { background: var(--surface-elevated); border-radius: 2px; }
  .toc-title { font-family: var(--font-mono); font-size: 9px; font-weight: 700; text-transform: uppercase; letter-spacing: 2px; color: var(--text-dim); padding: 0 0 10px; margin-bottom: 8px; border-bottom: 1px solid var(--border); }
  .toc a { display: block; font-size: 11px; color: var(--text-dim); text-decoration: none; padding: 4px 8px; border-radius: 5px; border-left: 2px solid transparent; transition: all 0.15s; line-height: 1.4; margin-bottom: 1px; }
  .toc a:hover { color: var(--text); background: var(--surface2); }
  .toc a.active { color: var(--text); border-left-color: var(--accent); }

  @media (max-width: 1000px) {
    .wrap { grid-template-columns: 1fr; padding-top: 0; }
    body { padding-top: 0; }
    .toc { position: sticky; top: 0; z-index: 200; max-height: none; display: flex; gap: 4px; align-items: center; overflow-x: auto; -webkit-overflow-scrolling: touch; background: var(--bg); border-bottom: 1px solid var(--border); padding: 10px 0; margin: 0 -40px; padding-left: 40px; padding-right: 40px; grid-row: auto; }
    .toc::-webkit-scrollbar { display: none; }
    .toc-title { display: none; }
    .toc a { white-space: nowrap; flex-shrink: 0; border-left: none; border-bottom: 2px solid transparent; border-radius: 4px 4px 0 0; padding: 6px 10px; font-size: 10px; }
    .toc a.active { border-left: none; border-bottom-color: var(--accent); background: var(--surface); }
    .main { padding-top: 20px; }
    .sec-head { scroll-margin-top: 52px; }
  }

  h1 { font-size: 38px; font-weight: 700; letter-spacing: -0.5px; margin-bottom: 6px; }
  h1 .hl { color: var(--accent); }
  .subtitle { color: var(--text-dim); font-family: var(--font-mono); font-size: 12px; margin-bottom: 12px; }
  .hero-links { display: flex; gap: 12px; flex-wrap: wrap; margin-bottom: 36px; }
  .hero-links a { display: inline-flex; align-items: center; gap: 6px; font-family: var(--font-mono); font-size: 12px; font-weight: 600; text-decoration: none; padding: 8px 16px; border-radius: 8px; transition: all 0.15s; }
  .btn-primary { background: var(--accent); color: #fff; }
  .btn-primary:hover { filter: brightness(1.15); }
  .btn-ghost { background: var(--surface); color: var(--text); border: 1px solid var(--border-bright); }
  .btn-ghost:hover { background: var(--surface2); }
  .sec-head { font-family: var(--font-mono); font-size: 13px; font-weight: 600; text-transform: uppercase; letter-spacing: 1.5px; color: var(--accent); padding: 24px 0 16px; border-bottom: 1px solid var(--border); margin-bottom: 20px; }

  /* KPI */
  .kpi-row { display: grid; grid-template-columns: repeat(auto-fit, minmax(130px, 1fr)); gap: 14px; margin-bottom: 28px; }
  .kpi-card { background: var(--surface-elevated); border: 1px solid var(--border); border-radius: 10px; padding: 18px; box-shadow: 0 2px 8px rgba(0,0,0,0.12); }
  .kpi-card__value { font-size: 28px; font-weight: 700; line-height: 1.1; font-variant-numeric: tabular-nums; }
  .kpi-card__label { font-family: var(--font-mono); font-size: 10px; font-weight: 600; text-transform: uppercase; letter-spacing: 1.2px; color: var(--text-dim); margin-top: 6px; }

  /* Tables */
  .table-wrap { background: var(--surface); border: 1px solid var(--border); border-radius: 12px; overflow: hidden; margin-bottom: 24px; }
  .table-scroll { overflow-x: auto; -webkit-overflow-scrolling: touch; }
  .dt { width: 100%; border-collapse: collapse; font-size: 13px; line-height: 1.55; }
  .dt thead { position: sticky; top: 0; z-index: 2; }
  .dt th { background: var(--surface2); font-family: var(--font-mono); font-size: 10px; font-weight: 600; text-transform: uppercase; letter-spacing: 1.2px; color: var(--text-dim); text-align: left; padding: 14px 16px; border-bottom: 2px solid var(--border-bright); white-space: nowrap; }
  .dt td { padding: 14px 16px; border-bottom: 1px solid var(--border); vertical-align: top; }
  .dt tbody tr:last-child td { border-bottom: none; }
  .dt .wide { min-width: 200px; max-width: 440px; }
  .dt tbody tr:nth-child(even) { background: var(--accent-dim); }
  .dt tbody tr { transition: background 0.15s ease; animation: fadeUp 0.35s ease-out both; animation-delay: calc(var(--i, 0) * 0.04s); }
  .dt tbody tr:hover { background: var(--border); }
  .dt code { font-family: var(--font-mono); font-size: 11px; background: var(--accent-dim); color: var(--accent); padding: 1px 5px; border-radius: 3px; }
  .dt small { display: block; color: var(--text-dim); font-size: 11px; margin-top: 3px; }
  .dt tfoot td { background: var(--surface2); font-weight: 600; font-family: var(--font-mono); font-size: 12px; border-top: 2px solid var(--border-bright); border-bottom: none; padding: 14px 16px; }

  /* Status */
  .s { display: inline-flex; align-items: center; gap: 5px; font-family: var(--font-mono); font-size: 10px; font-weight: 600; padding: 3px 10px; border-radius: 6px; white-space: nowrap; letter-spacing: 0.3px; }
  .s::before { content: ''; width: 6px; height: 6px; border-radius: 50%; background: currentColor; }
  .s-g { background: var(--green-dim); color: var(--green); }
  .s-r { background: var(--red-dim); color: var(--red); }
  .s-o { background: var(--orange-dim); color: var(--orange); }
  .s-b { background: var(--blue-dim); color: var(--blue); }
  .s-p { background: var(--purple-dim); color: var(--purple); }
  .s-c { background: var(--cyan-dim); color: var(--cyan); }

  /* Cards */
  .node { background: var(--surface); border: 1px solid var(--border); border-radius: 10px; padding: 20px; margin-bottom: 16px; overflow-wrap: break-word; min-width: 0; }
  .node--hero { background: color-mix(in srgb, var(--surface) 92%, var(--accent) 8%); box-shadow: 0 4px 20px rgba(0,0,0,0.15); border-color: color-mix(in srgb, var(--border) 50%, var(--accent) 50%); }
  .node h3 { font-size: 16px; font-weight: 600; margin-bottom: 8px; }
  .node p, .node li { font-size: 13px; line-height: 1.7; color: var(--text-dim); }
  .node ul { padding-left: 0; list-style: none; }
  .node li { padding-left: 14px; position: relative; margin-bottom: 4px; }
  .node li::before { content: 'â€º'; color: var(--accent); font-weight: 600; position: absolute; left: 0; }
  .node code { font-family: var(--font-mono); font-size: 11px; background: var(--accent-dim); color: var(--accent); padding: 1px 5px; border-radius: 3px; }
  .node strong { color: var(--text); }

  /* Install block */
  .install { background: var(--surface); border: 1px solid var(--border); border-radius: 10px; padding: 20px; margin-bottom: 16px; font-family: var(--font-mono); font-size: 13px; overflow-x: auto; }
  .install .prompt { color: var(--text-dim); user-select: none; }
  .install .cmd { color: var(--accent); }
  .install .comment { color: var(--text-dim); font-size: 11px; }

  /* Architecture grid */
  .arch-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-bottom: 24px; }
  .arch-grid > * { min-width: 0; overflow-wrap: break-word; }
  @media (max-width: 768px) { .arch-grid { grid-template-columns: 1fr; } body { padding: 16px; } h1 { font-size: 28px; } }

  /* Collapsible */
  details.col { border: 1px solid var(--border); border-radius: 10px; overflow: hidden; margin-bottom: 20px; }
  details.col summary { padding: 14px 20px; background: var(--surface); font-family: var(--font-mono); font-size: 12px; font-weight: 600; cursor: pointer; list-style: none; display: flex; align-items: center; gap: 8px; color: var(--text); transition: background 0.15s ease; }
  details.col summary:hover { background: var(--surface-elevated); }
  details.col summary::-webkit-details-marker { display: none; }
  details.col summary::before { content: 'â–¸'; font-size: 11px; color: var(--text-dim); transition: transform 0.15s ease; }
  details.col[open] summary::before { transform: rotate(90deg); }
  details.col .cb { padding: 16px 20px; border-top: 1px solid var(--border); font-size: 13px; line-height: 1.6; color: var(--text-dim); }
  details.col .cb strong { color: var(--text); }
  details.col .cb code { font-family: var(--font-mono); font-size: 11px; background: var(--accent-dim); color: var(--accent); padding: 1px 5px; border-radius: 3px; }

  .lineage { margin-top: 8px; padding-top: 16px; border-top: 1px solid var(--border); font-size: 12px; color: var(--text-dim); }
  .lineage a { color: var(--accent); text-decoration: none; }
  .lineage a:hover { text-decoration: underline; }
</style>
</head>
<body>
<div class="wrap">

<nav class="toc" id="toc">
  <div class="toc-title">Contents</div>
  <a href="#s1">1. Why</a>
  <a href="#s2">2. Install</a>
  <a href="#s3">3. Features</a>
  <a href="#s4">4. Architecture</a>
  <a href="#s5">5. vs Other Agents</a>
  <a href="#s6">6. vs Pi Extensions</a>
  <a href="#s7">7. Lineage</a>
</nav>

<div class="main">

<h1 class="a" style="--i:0"><span class="hl">pi-rewind</span></h1>
<p class="subtitle a" style="--i:1">The rewind experience Pi deserves â€” per-tool checkpoints, /rewind command, safe restore, redo stack</p>

<div class="hero-links a" style="--i:2">
  <a href="https://github.com/arpagon/pi-rewind" class="btn-primary">âŒ˜ GitHub</a>
  <a href="https://www.npmjs.com/package/pi-rewind" class="btn-ghost">npm</a>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â• KPI â•â•â•â•â•â•â•â•â•â•â• -->
<div class="kpi-row">
  <div class="kpi-card as" style="--i:3"><div class="kpi-card__value" style="color:var(--accent)">1,585</div><div class="kpi-card__label">Lines of Code</div></div>
  <div class="kpi-card as" style="--i:4"><div class="kpi-card__value" style="color:var(--green)">19</div><div class="kpi-card__label">Tests Passing</div></div>
  <div class="kpi-card as" style="--i:5"><div class="kpi-card__value">5</div><div class="kpi-card__label">Source Files</div></div>
  <div class="kpi-card as" style="--i:6"><div class="kpi-card__value" style="color:var(--cyan)">0</div><div class="kpi-card__label">Dependencies</div></div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â• 1: WHY â•â•â•â•â•â•â•â•â•â•â• -->
<div id="s1" class="sec-head a" style="--i:7">1 â€” Why pi-rewind?</div>

<div class="node node--hero a" style="--i:8">
  <h3>Pi already had checkpoint extensions. This one combines the best of all of them.</h3>
  <p><a href="https://github.com/prateekmedia/pi-hooks/tree/main/checkpoint" style="color:var(--accent)">checkpoint-pi</a> brought safe restore and smart filtering. <a href="https://github.com/nicobailon/pi-rewind-hook" style="color:var(--accent)">pi-rewind-hook</a> added resume checkpoints and status UI. But neither had a dedicated <code>/rewind</code> command, per-tool granularity, or a redo stack â€” features that Claude Code, Cline, and OpenCode ship built-in.</p>
  <p style="margin-top:10px">We researched <strong>11 coding agents</strong> (820K tokens of analysis), studied both existing Pi extensions, and merged the best ideas into one extension that closes every gap.</p>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â• 2: INSTALL â•â•â•â•â•â•â•â•â•â•â• -->
<div id="s2" class="sec-head a" style="--i:9">2 â€” Install</div>

<div class="install a" style="--i:10">
  <div class="comment"># From npm (recommended)</div>
  <div><span class="prompt">$ </span><span class="cmd">pi install npm:pi-rewind</span></div>
  <br>
  <div class="comment"># From GitHub</div>
  <div><span class="prompt">$ </span><span class="cmd">pi install github.com/arpagon/pi-rewind</span></div>
  <br>
  <div class="comment"># For development</div>
  <div><span class="prompt">$ </span><span class="cmd">git clone git@github.com:arpagon/pi-rewind.git</span></div>
  <div><span class="prompt">$ </span><span class="cmd">pi -e ./pi-rewind/src/index.ts</span></div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â• 3: FEATURES â•â•â•â•â•â•â•â•â•â•â• -->
<div id="s3" class="sec-head a" style="--i:11">3 â€” Features</div>

<div class="table-wrap a" style="--i:12">
  <div class="table-scroll">
    <table class="dt">
      <thead><tr><th class="wide">Feature</th><th>Trigger</th><th>Status</th></tr></thead>
      <tbody>
        <tr style="--i:1"><td class="wide">Per-tool checkpointing<small>After every write, edit, bash</small></td><td><code>tool_execution_end</code></td><td><span class="s s-g">Done</span></td></tr>
        <tr style="--i:2"><td class="wide">Per-turn checkpointing<small>Snapshot at start of every turn</small></td><td><code>turn_start</code></td><td><span class="s s-g">Done</span></td></tr>
        <tr style="--i:3"><td class="wide"><code>/rewind</code> command<small>Checkpoint browser â†’ diff preview â†’ restore</small></td><td>Type <code>/rewind</code></td><td><span class="s s-g">Done</span></td></tr>
        <tr style="--i:4"><td class="wide"><code>Esc+Esc</code> shortcut<small>Quick files-only rewind</small></td><td>Double Escape</td><td><span class="s s-g">Done</span></td></tr>
        <tr style="--i:5"><td class="wide">Restore modes<small>Files + conversation, files only, conversation only</small></td><td>Picker menu</td><td><span class="s s-g">Done</span></td></tr>
        <tr style="--i:6"><td class="wide">Redo stack<small>Multi-level undo of rewinds</small></td><td>"â†© Undo last rewind"</td><td><span class="s s-g">Done</span></td></tr>
        <tr style="--i:7"><td class="wide">Safe restore<small>Never deletes node_modules, .venv, large files</small></td><td>Automatic</td><td><span class="s s-g">Done</span></td></tr>
        <tr style="--i:8"><td class="wide">Smart filtering<small>Ignores 13 dir patterns + files &gt;10MiB + dirs &gt;200 files</small></td><td>Automatic</td><td><span class="s s-g">Done</span></td></tr>
        <tr style="--i:9"><td class="wide">Resume checkpoint<small>Snapshot on session start for fallback</small></td><td><code>session_start</code></td><td><span class="s s-g">Done</span></td></tr>
        <tr style="--i:10"><td class="wide">Footer status<small><code>â—† 5 checkpoints</code> in footer</small></td><td>Automatic</td><td><span class="s s-g">Done</span></td></tr>
        <tr style="--i:11"><td class="wide">Auto-pruning<small>Keeps max 100 checkpoints per session</small></td><td><code>turn_end</code></td><td><span class="s s-g">Done</span></td></tr>
        <tr style="--i:12"><td class="wide">Fork/tree integration<small>Restore prompts on /fork and /tree navigation</small></td><td><code>session_before_fork/tree</code></td><td><span class="s s-g">Done</span></td></tr>
        <tr style="--i:13"><td class="wide">Git refs storage<small>Survives restarts under <code>refs/pi-checkpoints/</code></small></td><td>Automatic</td><td><span class="s s-g">Done</span></td></tr>
        <tr style="--i:14"><td class="wide">Diff preview<small>Show changes before confirming restore</small></td><td><code>/rewind</code> flow</td><td><span class="s s-g">Done</span></td></tr>
        <tr style="--i:15"><td class="wide">"Summarize from here"<small>Compact conversation from checkpoint forward</small></td><td><code>ctx.compact()</code></td><td><span class="s s-o">Planned</span></td></tr>
      </tbody>
      <tfoot><tr><td>15 features</td><td></td><td><span class="s s-g">14 done</span></td></tr></tfoot>
    </table>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â• 4: ARCHITECTURE â•â•â•â•â•â•â•â•â•â•â• -->
<div id="s4" class="sec-head a" style="--i:13">4 â€” Architecture</div>

<div class="node a" style="--i:14">
  <h3>Two-layer split: core is independently testable</h3>
  <p><code>core.ts</code> has zero Pi dependency â€” pure git operations via <code>spawn()</code>. The extension layer (<code>index.ts</code>) wires Pi events to core functions. This means the 646-line core can be tested with just git and Node.js, no Pi runtime needed.</p>
</div>

<div class="arch-grid">
  <div class="node a" style="--i:15">
    <h3>ðŸ“¦ Source files</h3>
    <ul>
      <li><code>src/core.ts</code> â€” 646 LOC<small>Git operations, filtering, safe restore</small></li>
      <li><code>src/index.ts</code> â€” 201 LOC<small>Pi event hooks, checkpoint scheduling</small></li>
      <li><code>src/commands.ts</code> â€” 328 LOC<small>/rewind, Esc+Esc, fork/tree handlers</small></li>
      <li><code>src/state.ts</code> â€” 50 LOC<small>Shared mutable state</small></li>
      <li><code>src/ui.ts</code> â€” 33 LOC<small>Footer status indicator</small></li>
    </ul>
  </div>
  <div class="node a" style="--i:16">
    <h3>ðŸ§ª Testing</h3>
    <ul>
      <li><code>tests/core.test.ts</code> â€” 327 LOC</li>
      <li>19 tests covering: utils, git helpers, CRUD, snapshot/restore, safe restore, tool checkpoints, pruning</li>
      <li>Runs on disposable temp repos â€” no fixtures</li>
      <li><code>npx tsx tests/core.test.ts</code></li>
    </ul>
  </div>
</div>

<details class="col a" style="--i:17">
  <summary>Checkpoint data structure</summary>
  <div class="cb">
    Each checkpoint stores in a git commit message:<br><br>
    <strong>Identity:</strong> <code>id</code>, <code>sessionId</code>, <code>trigger</code> (turn/tool/resume/before-restore), <code>turnIndex</code>, <code>toolName</code><br>
    <strong>Git state:</strong> <code>headSha</code>, <code>indexTreeSha</code> (staged), <code>worktreeTreeSha</code> (full snapshot)<br>
    <strong>Safety:</strong> <code>preexistingUntrackedFiles[]</code>, <code>skippedLargeFiles[]</code>, <code>skippedLargeDirs[]</code><br><br>
    Restore is a 4-step process: <code>reset --hard HEAD</code> â†’ <code>read-tree -u worktree</code> â†’ safe clean (only new files) â†’ <code>read-tree index</code>
  </div>
</details>

<!-- â•â•â•â•â•â•â•â•â•â•â• 5: VS AGENTS â•â•â•â•â•â•â•â•â•â•â• -->
<div id="s5" class="sec-head a" style="--i:18">5 â€” vs Other Coding Agents</div>

<p class="a" style="--i:19; margin-bottom:16px; color:var(--text-dim); font-size:13px;">Based on research across 11 agents (820K tokens analyzed via Codex). Ranked by rewind completeness.</p>

<div class="table-wrap a" style="--i:20">
  <div class="table-scroll">
    <table class="dt">
      <thead><tr><th>#</th><th>Agent</th><th class="wide">Rewind feature</th><th>Per-tool</th><th>Redo</th><th>Files + Conv</th></tr></thead>
      <tbody>
        <tr style="--i:1"><td>1</td><td><strong>Cline</strong></td><td class="wide">Checkpoints per tool call, Compare/Restore UI</td><td><span class="s s-g">Yes</span></td><td><span class="s s-r">No</span></td><td><span class="s s-g">Yes</span></td></tr>
        <tr style="--i:2"><td>2</td><td><strong>Gemini CLI</strong></td><td class="wide"><code>/rewind</code> + <code>Esc+Esc</code> + <code>/restore</code></td><td><span class="s s-r">No</span></td><td><span class="s s-r">No</span></td><td><span class="s s-g">Yes</span></td></tr>
        <tr style="--i:3"><td>3</td><td><strong>Claude Code</strong></td><td class="wide"><code>/rewind</code> + <code>Esc+Esc</code>, "Summarize from here"</td><td><span class="s s-r">No</span></td><td><span class="s s-r">No</span></td><td><span class="s s-g">Yes</span></td></tr>
        <tr style="--i:4"><td>4</td><td><strong>OpenCode</strong></td><td class="wide"><code>/undo</code> + <code>/redo</code>, step-level patches</td><td><span class="s s-g">Yes</span></td><td><span class="s s-g">Yes</span></td><td><span class="s s-g">Yes</span></td></tr>
        <tr style="--i:5"><td>â€”</td><td style="color:var(--accent)"><strong>pi-rewind</strong></td><td class="wide" style="color:var(--accent)"><code>/rewind</code> + <code>Esc+Esc</code>, per-tool, redo stack, safe restore</td><td><span class="s s-g">Yes</span></td><td><span class="s s-g">Yes</span></td><td><span class="s s-g">Yes</span></td></tr>
        <tr style="--i:6"><td>9</td><td>Aider</td><td class="wide"><code>/undo</code> â€” last aider commit only</td><td><span class="s s-r">No</span></td><td><span class="s s-r">No</span></td><td><span class="s s-r">No</span></td></tr>
        <tr style="--i:7"><td>10</td><td>Codex CLI</td><td class="wide"><code>Esc+Esc</code> thread rollback (conversation only)</td><td><span class="s s-r">No</span></td><td><span class="s s-r">No</span></td><td><span class="s s-o">Conv only</span></td></tr>
      </tbody>
    </table>
  </div>
</div>

<div class="node a" style="--i:21">
  <h3>What pi-rewind combines from the best</h3>
  <ul>
    <li><strong>From Cline:</strong> Per-tool checkpointing granularity</li>
    <li><strong>From Claude Code / Gemini:</strong> <code>/rewind</code> command + <code>Esc+Esc</code> shortcut</li>
    <li><strong>From OpenCode:</strong> Redo stack for multi-level undo</li>
    <li><strong>From Claude Code:</strong> Diff preview before restore (planned: "Summarize from here")</li>
    <li><strong>Unique to pi-rewind:</strong> Safe restore that never deletes node_modules, .venv, or large files</li>
  </ul>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â• 6: VS PI EXTENSIONS â•â•â•â•â•â•â•â•â•â•â• -->
<div id="s6" class="sec-head a" style="--i:22">6 â€” vs Existing Pi Extensions</div>

<div class="table-wrap a" style="--i:23">
  <div class="table-scroll">
    <table class="dt">
      <thead><tr><th class="wide">Capability</th><th>checkpoint-pi</th><th>pi-rewind-hook</th><th style="color:var(--accent)">pi-rewind</th></tr></thead>
      <tbody>
        <tr style="--i:1"><td class="wide">Dedicated <code>/rewind</code> command</td><td><span class="s s-r">No</span></td><td><span class="s s-r">No</span></td><td><span class="s s-g">Yes</span></td></tr>
        <tr style="--i:2"><td class="wide"><code>Esc+Esc</code> shortcut</td><td><span class="s s-r">No</span></td><td><span class="s s-r">No</span></td><td><span class="s s-g">Yes</span></td></tr>
        <tr style="--i:3"><td class="wide">Per-tool checkpointing</td><td><span class="s s-r">No</span></td><td><span class="s s-r">No</span></td><td><span class="s s-g">Yes</span></td></tr>
        <tr style="--i:4"><td class="wide">Diff preview before restore</td><td><span class="s s-r">No</span></td><td><span class="s s-r">No</span></td><td><span class="s s-g">Yes</span></td></tr>
        <tr style="--i:5"><td class="wide">Redo stack (multi-level undo)</td><td><span class="s s-r">No</span></td><td><span class="s s-r">No</span></td><td><span class="s s-g">Yes</span></td></tr>
        <tr style="--i:6"><td class="wide">Safe restore (preserve untracked)</td><td><span class="s s-g">Yes</span></td><td><span class="s s-r">No</span></td><td><span class="s s-g">Yes</span></td></tr>
        <tr style="--i:7"><td class="wide">Smart filtering (13 dirs, large files)</td><td><span class="s s-g">Yes</span></td><td><span class="s s-r">No</span></td><td><span class="s s-g">Yes</span></td></tr>
        <tr style="--i:8"><td class="wide">HEAD + index + worktree capture</td><td><span class="s s-g">Yes</span></td><td><span class="s s-r">No</span></td><td><span class="s s-g">Yes</span></td></tr>
        <tr style="--i:9"><td class="wide">Resume checkpoint (session start)</td><td><span class="s s-r">No</span></td><td><span class="s s-g">Yes</span></td><td><span class="s s-g">Yes</span></td></tr>
        <tr style="--i:10"><td class="wide">Footer status indicator</td><td><span class="s s-r">No</span></td><td><span class="s s-g">Yes</span></td><td><span class="s s-g">Yes</span></td></tr>
        <tr style="--i:11"><td class="wide">Auto-pruning</td><td><span class="s s-r">No</span></td><td><span class="s s-g">Yes</span></td><td><span class="s s-g">Yes</span></td></tr>
        <tr style="--i:12"><td class="wide">Undo last rewind</td><td><span class="s s-g">Yes</span></td><td><span class="s s-g">Yes</span></td><td><span class="s s-g">Yes</span></td></tr>
        <tr style="--i:13"><td class="wide">Unit tests</td><td><span class="s s-g">906 LOC</span></td><td><span class="s s-r">None</span></td><td><span class="s s-g">327 LOC</span></td></tr>
        <tr style="--i:14"><td class="wide">Two-layer architecture (testable core)</td><td><span class="s s-g">Yes</span></td><td><span class="s s-r">No</span></td><td><span class="s s-g">Yes</span></td></tr>
        <tr style="--i:15"><td class="wide">No shell injection (<code>spawn()</code> only)</td><td><span class="s s-g">Yes</span></td><td><span class="s s-o">Partial</span></td><td><span class="s s-g">Yes</span></td></tr>
      </tbody>
      <tfoot>
        <tr><td>15 capabilities</td><td><span class="s s-g">8</span></td><td><span class="s s-g">5</span></td><td><span class="s s-g">15</span></td></tr>
      </tfoot>
    </table>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â• 7: LINEAGE â•â•â•â•â•â•â•â•â•â•â• -->
<div id="s7" class="sec-head a" style="--i:24">7 â€” Lineage &amp; Credits</div>

<div class="node a" style="--i:25">
  <h3>Built on the shoulders of two great Pi extensions</h3>
  <p>pi-rewind is not a clone â€” it's a clean-room rewrite that combines the best architectural decisions from both projects with new features inspired by the top coding agents.</p>
  <div class="lineage">
    <strong>Base architecture:</strong> <a href="https://github.com/prateekmedia/pi-hooks/tree/main/checkpoint">checkpoint-pi</a> by prateekmedia â€” two-layer design, safe restore, smart filtering, unit tests<br>
    <strong>UX inspiration:</strong> <a href="https://github.com/nicobailon/pi-rewind-hook">pi-rewind-hook</a> by nicobailon â€” resume checkpoint, footer status, notifications, auto-pruning<br>
    <strong>Feature targets:</strong> Cline (per-tool), Claude Code (/rewind + Esc+Esc), OpenCode (/undo + /redo), Gemini CLI (/rewind + /restore)
  </div>
</div>

<div class="node a" style="--i:26" style="text-align:center">
  <p style="color:var(--text-dim); font-size:12px; font-family:var(--font-mono);">MIT License Â· <a href="https://github.com/arpagon/pi-rewind" style="color:var(--accent); text-decoration:none;">github.com/arpagon/pi-rewind</a></p>
</div>

</div><!-- /main -->
</div><!-- /wrap -->

<script>
(function() {
  const toc = document.getElementById('toc');
  const links = toc.querySelectorAll('a');
  const sections = [];
  links.forEach(link => {
    const id = link.getAttribute('href').slice(1);
    const el = document.getElementById(id);
    if (el) sections.push({ id, el, link });
  });
  const observer = new IntersectionObserver(entries => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        links.forEach(l => l.classList.remove('active'));
        const match = sections.find(s => s.el === entry.target);
        if (match) {
          match.link.classList.add('active');
          if (window.innerWidth <= 1000) match.link.scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'center' });
        }
      }
    });
  }, { rootMargin: '-10% 0px -80% 0px' });
  sections.forEach(s => observer.observe(s.el));
  links.forEach(link => {
    link.addEventListener('click', e => {
      e.preventDefault();
      const el = document.getElementById(link.getAttribute('href').slice(1));
      if (el) { el.scrollIntoView({ behavior: 'smooth', block: 'start' }); history.replaceState(null, '', link.getAttribute('href')); }
    });
  });
})();
</script>
</body>
</html>
